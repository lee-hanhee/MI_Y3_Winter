\begin{definition}
    Vertices represent random variables and edges represent dependencies between variables.
\end{definition}

\subsection{Junction}
\begin{definition}
    A \textbf{junction} $\mathcal{J}$ consists of three vertices, $X_1$, $X_2$, and $X_3$, connected by two edges, $e_1$ and $e_2$:
    \customFigure[0.5]{../Images/L6_2.png}{}
    \begin{itemize}
        \item $X_1$ and $X_2$ are not independent, $X_2$ and $X_3$ are not independent, but when is $X_1$ and $X_3$ independent?
    \end{itemize}
\end{definition}

\subsubsection{Causal Chain}
\begin{definition}
    A causal chain is a junction $\mathcal{J}$ s.t. 
    \customFigure[0.5]{../Images/L6_3.png}{}
    \begin{itemize}
        \item $X_1$ and $X_3$ are not independent (unconditionally), but are independent given $X_2$.
    \end{itemize}
\end{definition}

\begin{notes}
    \begin{itemize}
        \item \textbf{Analogy:}  Given $X_2$, $X_1$ and $X_3$ are independent. Why? $X_2$'s door closes when you know $X_2$, so $X_1$ and $X_3$ are independent.
        \item \textbf{Distinction b/w Causal and Dependence:} $X_1$ and $X_2$ are dependent. However, from a causal perspective, $X_1$ is influencing $X_2$ (i.e. $X_1 \rightarrow X_2$).
    \end{itemize}
\end{notes}

\subsubsection{Common Cause}
\begin{definition}
    A common cause is a junction $\mathcal{J}$ s.t.
    \customFigure[0.5]{../Images/L6_4.png}{}
    \begin{itemize}
        \item $X_1$ and $X_3$ are not independent (unconditionally), but are independent given $X_2$.
    \end{itemize}
\end{definition}

\begin{notes}
    \begin{itemize}
        \item \textbf{Analogy:} Given $X_2$, $X_1$ and $X_3$ are independent. Why? Consider the following example:
        \begin{itemize}
            \item Let $X_2$ represent whether a person smokes or not, $X_1$ represent whether they have yellow teeth, $X_3$ represent whether they have lung cancer.
        \end{itemize}
        \item Without knowing $X_2$, observing $X_1$ provides information about $X_3$ because yellow teeth are associated with smoking, which in turn increases the likelihood of lung cancer. 
        \item If $X_2$ is known, then knowing whether a person has yellow teeth provides no additional information about whether they have lung cancer beyond what is already known from smoking status. 
    \end{itemize}
\end{notes}


\subsubsection{Common Effect}
\begin{definition}
    A common effect is a junction $\mathcal{J}$ s.t.
    \customFigure[0.5]{../Images/L6_5.png}{}
    \begin{itemize}
        \item $X_1$ and $X_3$ are independent (unconditionally), but are not independent given $X_2$ or any of $X_2$'s descendents.
    \end{itemize}
\end{definition}

\begin{notes}
    \begin{itemize}
        \item \textbf{Analogy:} Consider the following example:
        \begin{itemize}
            \item Let $X_2$ represent whether the grass is wet, $X_1$ represent whether it rained, $X_3$ represent whether the sprinkler was on.
        \end{itemize}
        \item Without knowing whether the grass is wet ($X_2$), the occurrence of rain ($X_1$) and the sprinkler being on ($X_3$) are independent events. The rain may occur regardless of the sprinkler, and vice versa.
        \item However, once we observe that the grass is wet ($X_2$), the two events become dependent:
        \begin{itemize}
            \item If we learn that the sprinkler was not on, then the wet grass must have been caused by rain.
            \item If we learn that it did not rain, then the wet grass must have been caused by the sprinkler.
        \end{itemize}
    \end{itemize}
\end{notes}
\newpage

\section{Dependence Separation}
\subsection{Independence}
\begin{theorem}
    Any two variables, $X_1$ and $X_2$, in a Bayesian network, $\mathcal{B} = (\mathcal{V}, \mathcal{E})$, are independent given $\mathcal{K} \subseteq \mathcal{V}$ if every undirected path is blocked.
\end{theorem}

\subsubsection{Blocked Undirected Path}
\begin{definition}
    An undirected path,
    \[
    p = \langle (X_1, e_1, X_2), \dots, (X_{|p|-1}, e_{|p|-1,|p|}, X_{|p|}) \rangle,
    \]
    \customFigure[0.5]{../Images/L6_13.png}{}
    is \textbf{blocked} given $\mathcal{K} \subseteq \mathcal{V}$ if any of its junctions,

    \[
    \mathcal{J}^{(n)} = \{(X_{n-1}, X_n, X_{n+1}), (e_{n-1}, e_n)\},
    \]
    is blocked given $\mathcal{K}$.
\end{definition}

\subsubsection{Blocked Junction}
\begin{definition}
    $\mathcal{J} = (\{X_1, X_2, X_3\}, \{e_1, e_2\})$ is \textbf{blocked} given $\mathcal{K} \subseteq \mathcal{V}$ if $X_1$ and $X_3$ are independent given $\mathcal{K}$.
\end{definition}

\subsection{Consequence of Dependence Separation}
\begin{theorem}
    For any variable, $X \in \mathcal{V}$, it can be shown that $X$ is independent of $X$'s non-descendants, $\mathcal{V} \setminus \operatorname{des}(X)$, given $X$'s parents, $\operatorname{pts}(X)$.
\end{theorem}

\begin{notes}
    \customFigure[0.5]{../Images/L6_8.png}{}
    \begin{itemize}
        \item Given $X$'s parent, apply junction rules to determine that $X$ is independent of its non-descendants.
        \item $\mathcal{J} = \{(Z_1, \text{pt}(X), X), (e_1,e)\}$ shows that $Z_1$ and $X$ are independent given $\text{pt}(X)$ (causal chain).
        \item $\mathcal{J} = \{(Z_2, \text{pt}(X), X), (e_2,e)\}$ shows that $Z_2$ and $X$ are independent given $\text{pt}(X)$ (common cause).
        \item Given $\text{ch}(X)$'s parent, apply junction rules to determine that $\text{ch}(X)$ is independent of its non-descendants.
        \item $\mathcal{J} = \{\text{pt}(X),X, \text{ch}(X)), (e,e')\}$ shows that $\text{pt}(X)$ and $\text{ch}(X)$ are independent given $X$ (causal chain).
        \item Given $Z_4$'s parent, apply junction rules to determine that $Z_4$ is independent of its non-descendants.
        \item $\mathcal{J} = \{X, \text{ch}(X), Z_4, (e',e_4)\}$ shows that $X$ and $Z_4$ are independent given $\text{ch}(X)$ (causal chain).
        \item CHECK THIS OVER AGAIN WITH THE PROFESSOR.
    \end{itemize}
\end{notes}
\newpage

\subsection{Canonical Problems}
\subsubsection{Undirected Path Blocked?}
\begin{process}
    \begin{enumerate}
        \item \textbf{Given:} Undirected path $p$ and $\mathcal{K}$
        \item Check if any of the junctions on the undirected path are blocked given $\mathcal{K}$.
        \begin{itemize}
            \item i.e. Check if $X_1$ and $X_3$ of the junction are independent given $\mathcal{K}$.
        \end{itemize}
    \end{enumerate}
\end{process}

\subsubsection{Independence}
\begin{process}
    \begin{enumerate}
        \item Given a Bayesian network w/ 2 variables to find independence.
        \item Find all undirected paths between the 2 variables in the Bayesian network.
        \item Identify a set of variables, $\mathcal{K}$, that block at least one junction in all undirected paths.
        \begin{itemize}
            \item Test a junction by seeing junction given relationships. 
        \end{itemize}
        \item If all undirected paths are blocked, then the 2 variables are independent given $\mathcal{K}$.
    \end{enumerate}
\end{process}

\begin{warning}
    \begin{itemize}
        \item Be careful of common effect, in which it is blocked by default. 
    \end{itemize}
\end{warning}

\begin{example}
    \begin{enumerate}
        \item \textbf{Given:} Bayesian network.
        \customFigure[0.25]{../Images/L6_7.png}{}
        \item \textbf{Problem:} $A$ and $E$ are 
        \begin{itemize}
            \item independent if $\mathcal{K}=$
            \item not necessarily independent for $\mathcal{K}=$
        \end{itemize}
        \item \textbf{Soln:}
        \begin{enumerate}
            \item \textbf{Undirected Paths:}
            \begin{itemize}
                \item $A \to G \to H \to B \to E$
                \item $A \to G \to D \to B \to E$
                \item $A \to C \to F \to B \to E$
                \item $A \to C \to D \to B \to E$
            \end{itemize}
        \end{enumerate}
    \end{enumerate}
\end{example}
\newpage

\begin{example}
    \textbf{Independent:}
    \begin{center}
        \begin{tabular}{c}
            \toprule
            $\mathcal{K}$ \\
            \midrule
            $\{G,C\}$ \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $A \iff G \iff H \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(A,G,H),(e_1,e_2)\}$ is blocked given $G$ since $A,H$ independent given $G$ (causal chain)
                    \item $A \iff G \iff D \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(A,G,D),(e_1,e_2)\}$ is blocked given $G$ since $A,D$ independent given $G$ (causal chain)
                    \item $A \iff C \iff F \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(A,C,F),(e_1,e_2)\}$ is blocked given $C$ since $A,F$ independent given $C$ (causal chain) 
                    \item $A \iff C \iff D \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(A,C,D),(e_1,e_2)\}$ is blocked given $C$ since $A,D$ independent given $C$ (causal chain) 
                \end{itemize}} \\
            \midrule
            $\{D,F\}$ \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $A \iff G \iff H \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(G,H,B),(e_1,e_2)\}$ is blocked NOT given $H$ since $G,B$ independent NOT given $H$ (common effect)
                    \item $A \iff G \iff D \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(G,D,B),(e_1,e_2)\}$ is blocked given $D$ since $G,B$ independent given $D$ (causal chain)
                    \item $A \iff C \iff F \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(C,F,B),(e_1,e_2)\}$ is blocked given $F$ since $C,B$ independent given $F$ (causal chain)
                    \item $A \iff C \iff D \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(C,D,B),(e_1,e_2)\}$ is blocked given $D$ since $C,B$ independent given $D$ (causal chain)
                \end{itemize}} \\
            \toprule
        \end{tabular}
    \end{center}
    \vspace{1em}

    \textbf{Not Necessarily Independent:}
    \begin{center}
        \begin{tabular}{c}
            \toprule
            $\mathcal{K}$ \\
            \midrule
            $\{H,D,F\}$ \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $A \iff G \iff H \iff B \iff E$ is unblocked given $\mathcal{K}$ since $\mathcal{J} = \{(G,H,B),(e_1,e_2)\}$ is unblocked given $H$ since $G,B$ not independent given $H$ (common effect)
                    \item $A \iff G \iff D \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(G,D,B),(e_1,e_2)\}$ is blocked given $D$ (causal chain) since $G,B$ independent given $D$ (causal chain)
                    \item $A \iff C \iff F \iff B \iff E$ is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(C,F,B),(e_1,e_2)\}$ is blocked given $F$ since $C,B$ independent given $F$ (causal chain)
                    \item $A \iff C \iff D \iff B \iff E$  is blocked given $\mathcal{K}$ since $\mathcal{J} = \{(C,D,B),(e_1,e_2)\}$ is blocked given $D$ since $C,B$ independent given $D$ (causal chain)
                \end{itemize}} \\
            \midrule
            \toprule
        \end{tabular}
    \end{center}
\end{example}
\newpage

\begin{example}
    Determine all subsets of $\{B,C,D,F,G,H\}$ for which $A$ and $E$ are independent. 
    \customFigure[0.25]{../Images/LR_1.png}{}
    \begin{enumerate}
        \item \textbf{Undirected Paths:}
        \begin{itemize}
            \item $A \to G \to H \to B \to E$
            \item $A \to G \to D \to B \to E$
            \item $A \to C \to F \to B \to E$
            \item $A \to C \to D \to B \to E$
        \end{itemize}
    \end{enumerate}
    \begin{center}
        \begin{tabular}{c}
            \toprule
            $\mathcal{K}$ \\
            \midrule
            $\{B\}$ (Any subset that contains $B$ will be independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $AGHBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(H,B,E),(e_1,e_2)\}$ is b since $H,E$ indep. given $B$ (causal chain)
                    \item $AGDBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(D,B,E),(e_1,e_2)\}$ is b since $D,E$ indep. given $B$ (causal chain)
                    \item $ACFBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(F,B,E),(e_1,e_2)\}$ is b since $F,E$ indep. given $B$ (causal chain) 
                    \item $ACDBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(D,B,E),(e_1,e_2)\}$ is b since $D,E$ indep. given $B$ (causal chain) 
                \end{itemize}} \\
            \midrule
            $\{C\}$ (Not independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $AGDBE$ is ub given $\mathcal{K}$ since $\forall \mathcal{J}$ on $p$, all are ub.
                \end{itemize}} \\
            \midrule
            $\{D\}$ (Not indepedent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $ACFBE$ is ub given $\mathcal{K}$ since $\forall \mathcal{J}$ on $p$, all are ub.
                \end{itemize}} \\
            \midrule
            $\{F\}$ (Not independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $AGDBE$ is ub given $\mathcal{K}$ since $\forall \mathcal{J}$ on $p$, all are ub.
                \end{itemize}} \\
            \midrule
            $\{G\}$ (Not independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $ACFBE$ is ub given $\mathcal{K}$ since $\forall \mathcal{J}$ on $p$, all are ub.
                \end{itemize}} \\
            \midrule
            $\{H\}$ (Not independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $ACFBE$ is ub given $\mathcal{K}$ since $\forall \mathcal{J}$ on $p$, all are ub.
                \end{itemize}} \\
            \toprule
        \end{tabular}
    \end{center}
\end{example}
\newpage

\begin{example}
    \begin{center}
        \begin{tabular}{c}
            \toprule
            $\mathcal{K}$ \\
            \midrule
            $\{C,D\}$ (Any subset that contains $C$ and $D$ except $H$ will be independent) \\
            \multicolumn{1}{p{\linewidth}}{
                \begin{itemize}
                    \item $AGHBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(G,H,B),(e_1,e_2)\}$ is b since $G,B$ indep. not given $H$ (causal effect)
                    \item $AGDBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(G,D,B),(e_1,e_2)\}$ is b since $G,B$ indep. given $D$ (causal chain)
                    \item $ACFBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(A,C,F),(e_1,e_2)\}$ is b since $A,F$ indep. given $C$ (causal chain)
                    \item $ACDBE$ is b given $\mathcal{K}$ since $\mathcal{J} = \{(A,C,D),(e_1,e_2)\}$ is b since $A,D$ indep. given $C$ (causal chain)
                \end{itemize}} \\
            \midrule
            $\ldots$ \\
            \toprule
        \end{tabular}
    \end{center}
\end{example}

\begin{example}
    Any set with 
    \begin{equation*}
        B \lor [(G \lor (D \land (\lnot H))) \land (C \lor F)]
    \end{equation*}
\end{example}
\newpage

\begin{example}
    
\end{example}

